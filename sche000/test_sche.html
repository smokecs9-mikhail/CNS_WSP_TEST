<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>단계별 영업 현황 추진 상황</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- 컨텍스트 메뉴 -->
    <div id="contextMenu" class="context-menu">
        <div class="context-menu-item" data-color="white">기본</div>
        <div class="context-menu-item" data-color="#ffebee">빨간색</div>
        <div class="context-menu-item" data-color="#e8f5e8">초록색</div>
        <div class="context-menu-item" data-color="#e3f2fd">파란색</div>
        <div class="context-menu-item" data-color="#fff3e0">주황색</div>
        <div class="context-menu-item" data-color="#f3e5f5">보라색</div>
        <div class="context-menu-item" data-color="#fce4ec">핑크색</div>
        <div class="context-menu-item" data-color="#e0f2f1">청록색</div>
    </div>

    <div class="container">
        <div class="header">
            <h1>단계별 영업현황 추진상황</h1>
            <div class="test-status">테스트 진행중 - 작성시 리얼타임 DB로 작동함</div>
        </div>
        
        <!-- Firebase 연결 경고 (표 위에 표시) -->
        <div id="firebaseWarning" class="firebase-warning" style="display: none;">
            <div class="warning-content">
                <span class="warning-icon">⚠️</span>
                <span class="warning-text">Firebase 연결되지 않음 - 데이터가 로컬에만 저장됩니다</span>
                <button id="retryFirebaseBtn" class="retry-btn">재연결</button>
            </div>
        </div>
        
        <div class="table-container">
            <table id="scheduleTable">
                <thead>
                    <tr class="main-header">
                        <th rowspan="3">NO</th>
                        <th rowspan="3">건물명</th>
                        <th rowspan="3">주소</th>
                        <th rowspan="3">준공일<br>(예정)</th>
                        <th rowspan="3">연면적<br>(평)</th>
                        <th colspan="12">추진상황</th>
                        <th rowspan="3">담당자</th>
                        <th rowspan="3">비고</th>
                    </tr>
                    <tr class="stage-header">
                        <th colspan="3">1단계</th>
                        <th colspan="3">2단계</th>
                        <th colspan="3">3단계</th>
                        <th colspan="3">4단계</th>
                    </tr>
                    <tr class="sub-header">
                        <th class="clickable-header" data-stage="1-1">1-1</th>
                        <th class="clickable-header" data-stage="1-2">1-2</th>
                        <th class="clickable-header" data-stage="1-3">1-3</th>
                        <th class="clickable-header" data-stage="2-1">2-1</th>
                        <th class="clickable-header" data-stage="2-2">2-2</th>
                        <th class="clickable-header" data-stage="2-3">2-3</th>
                        <th class="clickable-header" data-stage="3-1">3-1</th>
                        <th class="clickable-header" data-stage="3-2">3-2</th>
                        <th class="clickable-header" data-stage="3-3">3-3</th>
                        <th class="clickable-header" data-stage="4-1">4-1</th>
                        <th class="clickable-header" data-stage="4-2">4-2</th>
                        <th class="clickable-header" data-stage="4-3">4-3</th>
                    </tr>
                </thead>
                <tbody id="tableBody">
                    <!-- 데이터 행들이 여기에 동적으로 추가됩니다 -->
                </tbody>
            </table>
        </div>
        
        <div class="controls">
            <button id="addRow" class="btn">행 추가</button>
            <button id="saveData" class="btn">데이터 저장(EXCEL)</button>
            <button id="loadData" class="btn">DB동기화</button>
        </div>
    </div>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script  type="module" src="script.js"></script>
</body>
</html>
